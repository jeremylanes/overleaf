'use strict';var m=require('path'),z=require('process'),w=require('fs'),url=require('url');function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var m__default=/*#__PURE__*/_interopDefault(m);var z__default=/*#__PURE__*/_interopDefault(z);var w__default=/*#__PURE__*/_interopDefault(w);var A=Object.create;var S=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var M=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty;var x=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var L=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Y=(t,e,r,c)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of O(e))!F.call(t,n)&&n!==r&&S(t,n,{get:()=>e[n],enumerable:!(c=D(e,n))||c.enumerable});return t};var q=(t,e,r)=>(r=t!=null?A(M(t)):{},Y(S(r,"default",{value:t,enumerable:!0}),t));var v=L((lt,g)=>{var{sep:V}=x("path"),$=t=>{for(let e of t){let r=/(\/|\\)/.exec(e);if(r!==null)return r[0]}return V};g.exports=function(e,r=$(e)){let[c="",...n]=e;if(c===""||n.length===0)return "";let a=c.split(r),s=a.length;for(let f of n){let o=f.split(r);for(let i=0;i<s;i++)o[i]!==a[i]&&(s=i);if(s===0)return ""}let u=a.slice(0,s).join(r);return u.endsWith(r)?u:u+r};});var R=q(v());var k={directory:"isDirectory",file:"isFile"};function W(t){if(!Object.hasOwnProperty.call(k,t))throw new Error(`Invalid type specified: ${t}`)}var B=(t,e)=>e[k[t]](),J=t=>t instanceof URL?url.fileURLToPath(t):t;function p(t,{cwd:e=z__default.default.cwd(),type:r="file",allowSymlinks:c=!0}={}){W(r),e=J(e);let n=c?w__default.default.statSync:w__default.default.lstatSync;for(let a of t)try{let s=n(m__default.default.resolve(e,a),{throwIfNoEntry:!1});if(!s)continue;if(B(r,s))return a}catch{}}var tt=t=>t instanceof URL?url.fileURLToPath(t):t,et=Symbol("findUpStop");function rt(t,e={}){let r=m__default.default.resolve(tt(e.cwd)||""),{root:c}=m__default.default.parse(r),n=e.stopAt||c,a=e.limit||Number.POSITIVE_INFINITY,s=[t].flat(),u=o=>{return p(s,o);},f=[];for(;;){let o=u({...e,cwd:r});if(o===et||(o&&f.push(m__default.default.resolve(r,o)),r===n||f.length>=a))break;r=m__default.default.dirname(r);}return f}function E(t,e={}){return rt(t,{...e,limit:1})[0]}function N({cwd:t}={}){let e=E("package.json",{cwd:t});return e&&m__default.default.dirname(e)}var{env:P,cwd:ct}=z__default.default,_=t=>{try{return w__default.default.accessSync(t,w__default.default.constants.W_OK),!0}catch{return !1}};function U(t,e){return e.create&&w__default.default.mkdirSync(t,{recursive:!0}),t}function it(t){let e=m__default.default.join(t,"node_modules");if(!(!_(e)&&(w__default.default.existsSync(e)||!_(m__default.default.join(t)))))return e}function I(t={}){if(P.CACHE_DIR&&!["true","false","1","0"].includes(P.CACHE_DIR))return U(m__default.default.join(P.CACHE_DIR,t.name),t);let{cwd:e=ct(),files:r}=t;if(r){if(!Array.isArray(r))throw new TypeError(`Expected \`files\` option to be an array, got \`${typeof r}\`.`);e=(0, R.default)(r.map(n=>m__default.default.resolve(e,n)));}if(e=N({cwd:e}),!(!e||!it(e)))return U(m__default.default.join(e,"node_modules",".cache",t.name),t)}function b(t){return t instanceof URL?url.fileURLToPath(t):t}var at=Symbol("findUpStop");function ft(t,e={}){let r=m__default.default.resolve(b(e.cwd)??""),{root:c}=m__default.default.parse(r),n=m__default.default.resolve(r,b(e.stopAt)??c),a=e.limit??Number.POSITIVE_INFINITY,s=[t].flat(),u=o=>{if(typeof t!="function")return p(s,o);let i=t(o.cwd);return typeof i=="string"?p([i],o):i},f=[];for(;;){let o=u({...e,cwd:r});if(o===at||(o&&f.push(m__default.default.resolve(r,o)),r===n||f.length>=a))break;r=m__default.default.dirname(r);}return f}function y(t,e={}){return ft(t,{...e,limit:1})[0]}function C(t,e="default"){let r=I({name:"storybook"});return r||=m.join(process.cwd(),".cache","storybook"),m.join(r,e,t)}var j=()=>{let t;if(process.env.STORYBOOK_PROJECT_ROOT)return process.env.STORYBOOK_PROJECT_ROOT;try{let e=y(".git",{type:"directory"});e&&(t=m.join(e,".."));}catch{}try{let e=y(".svn",{type:"directory"});e&&(t=t||m.join(e,".."));}catch{}try{let e=y(".hg",{type:"directory"});e&&(t=t||m.join(e,".."));}catch{}try{let e=__dirname.split("node_modules");t=t||(e.length>=2?e[0]:void 0);}catch{}try{let e=y(".yarn",{type:"directory"});e&&(t=t||m.join(e,".."));}catch{}return t||process.cwd()};var ut=[/storybook-config-entry\.js$/,/storybook-stories\.js$/],re=async(t,e)=>{let r=await e.presets.apply("babel",{},e),c=await e.presets.apply("typescript",{},e);return t.module={...t.module||{},rules:[...t.module?.rules||[],{test:c.skipCompiler?/\.((c|m)?jsx?)$/:/\.((c|m)?(j|t)sx?)$/,use:[{loader:x.resolve("babel-loader"),options:{cacheDirectory:C("babel"),...r}}],include:[j()],exclude:[/node_modules/,...ut]}]},t};exports.webpackFinal=re;